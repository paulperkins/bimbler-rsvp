#!/bin/sh

set -x

#dpkg-reconfigure tzdata

apt-get -y install zip
apt-get -y install unzip

apt-get -y install apache2 apache2-utils

#000-sites-available
#mods-enabled
#apache.conf

apt-get -y install iptables-persistent

apt-get -y install mysql-client mysql-server

apt-get -y install software-properties-common python-software-properties

apt-get -y install postfix
# edit /etc/postfix/main.cf
apt-get -y install mailutils

#add-apt-repository ppa:ondrej/php

# OR

#echo '' >> /etc/apt/sources.list
#echo 'deb http://repozytorium.mati75.eu/raspbian jessie-backports main contrib non-free' >> /etc/apt/sources.list
#echo '#deb-src http://repozytorium.mati75.eu/raspbian jessie-backports main contrib non-free' >> /etc/apt/sources.list

#sudo gpg --keyserver pgpkeys.mit.edu --recv-key CCD91D6111A06851

#sudo gpg --armor --export CCD91D6111A06851 | sudo apt-key add -

#apt-get update

apt-get -y install php7.0 php7.0-mysql libapache2-mod-php7.0 php7.0-cli php7.0-cgi php7.0-gd php7.0-curl php7.0-soap php7.0-xml php7.0-mbstring

#apt-get -t jessie-backports install apache2 php7.0 php7.0-curl php7.0-gd php7.0-imap php7.0-json php7.0-mcrypt php7.0-mysql php7.0-opcache php7.0-xmlrpc libapache2-mod-php7.0


wget -c http://wordpress.org/latest.tar.gz
tar -zxvf latest.tar.gz

rsync -av wordpress/* /var/www/this_machine/

chown -R www-data:www-data /var/www/this_machine/

echo 'create database wordpress;' > ~/create_db.sql
echo 'create user '\''wordpress'\''@localhost identified by '\''w0rdpr3ss'\'';' >> ~/create_db.sql
echo 'grant all privileges on wordpress.* to '\''wordpress'\''@localhost with grant option;' >> ~/create_db.sql
echo 'flush privileges;' >> ~/create_db.sql

mysql --user=root -p < ~/create_db.sql


